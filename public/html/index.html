<!DOCTYPE html>
<html ng-app="app">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	    <meta charset="utf-8">
	    <title>Test</title>
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
	    <meta name="description" content="">

	    <link href="../stylesheets/bootstrap.min.css" rel="stylesheet" type="text/css">
	    <!-- <link rel="stylesheet" href="../stylesheets/font-awesome.css"> -->
	    <link href="//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
	    
		<style type="text/less">
			body { font-family:Arial; font-size:14px; }
			body>span, body>h1 { float:left; width:100%; margin:0; padding:0; margin-bottom:10px; }
			
			span { color:#888888;
                >b { color:black; }
            }
            
            .vertical-centre (@height) { height:@height; line-height:@height !important; display:inline-block; vertical-align:middle; }
            .border-box { box-sizing:border-box; -moz-box-sizing:border-box; }

            @border-colour:#CCC;
            calendar { float:left; display:block; .border-box; background:white; width:300px; border:solid 1px @border-colour; margin-bottom:10px;
                @secondary-colour:#2875C7;
                @spacing:10px;
                
                @icon-width:40px;
                @header-height:40px;
                
                >div.header { float:left; width:100%; background:@secondary-colour; height:@header-height; color:white;
                    >* { .vertical-centre(@header-height); }
                    >i { float:left; width:@icon-width; font-size:1.125em; font-weight:bold; position:relative; .border-box; padding:0 @spacing; cursor:pointer; }
                    >i.fa-angle-left { text-align:left; }
                    >i.fa-angle-right { text-align:right; margin-left:@icon-width*-1; }
                    >span { float:left; width:100%; font-weight:bold; text-transform:uppercase; .border-box; padding-left:@icon-width+@spacing; margin-left:@icon-width*-1; text-align:center; padding-right:@icon-width; color:inherit; }
                }
                >div.week { float:left; width:100%; border-top:solid 1px @border-colour;
                    &:first-child { border-top:none; }
                    >span.day { float:left; width:100%/7; .border-box; border-left:solid 1px @border-colour; font-size:0.75em; text-align:center; .vertical-centre(30px); background:white; cursor:pointer; color:black;
                        &:first-child { border-left:none; }
                        &.today { background:#E3F2FF; }
                        &.different-month { color:#C0C0C0; }
                        &.selected { background:@secondary-colour; color:white; }
                    }
                    &.names>span { color:@secondary-colour; font-weight:bold; }
                }
            }
        </style>
	</head>
	<body ng-controller="userController as ctrl">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-3">
					<calendar selected="day"></calendar>
					<span>choose date:  {{day.format('YYYY-MM-DD')}}</span>
				</div>
				<div class="col-md-6 well">
					<h4>Didn't finish task in last two days</h4>
					<table class="table">
						<thead>
							<tr>
								<th>name</th>
								<th>Days</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="item in ctrl.unSignUsers">
								<td>{{item._id}}</td>
								<td>{{item.count}}Day</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="row">
				<div class="col-md-9">
					<h3>User list</h3>
					<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
						添加工会成员
					</button>

					<!-- Modal -->
					<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
					  <div class="modal-dialog" role="document">
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					        <h4 class="modal-title" id="myModalLabel">添加工会成员</h4>
					      </div>
					      <div class="modal-body">
					        	 <form>
									<div class="form-group">
										<label for="name">游戏名:</label>
										<input type="text" class="form-control" id="name" ng-model="name" placeholder="please input a user name">
									</div>
								</form>
					      </div>
					      <div class="modal-footer">
					        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
					        <button type="button" class="btn btn-primary" ng-click="ctrl.addUser()">Add</button>
					      </div>
					    </div>
					  </div>
					</div>

					<!-- score part -->
					<table class="table">
						<thead>
							<tr>
								<th>name</th>
								<th ng-repeat="day in ctrl.duration">{{day.format('MM-DD')}}</th>
								<th>累计未做天数</th>
								<th>当日完成情况</th>
								<th>action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="(name, scoreList) in ctrl.userListInPeriod">
								<td>{{name}}</td>
								<td ng-repeat="item in scoreList" ng-dblclick="ctrl.showEdit(item)" ng-class="ctrl.getCss(item)">
									<span ng-if="!item.edit">
										{{item.score}}
									</span>
									<input ng-if="item.edit" type="number" ng-model="item.score" ng-blur="ctrl.saveScore(item)" min="0" required>
								</td>
								<td>{{ctrl.unSignUsersTotal[name]}}</td>
								<td ng-class="ctrl.getCss(scoreList[scoreList.length-1])">{{scoreList[scoreList.length-1].sign}}</td>
								<td>
									<button class="btn btn-primary" ng-click="ctrl.removeUser(name, $index)">Delete</button>
								</td>
							</tr>
						</tbody>
					</table>

					<!-- sign part -->
					<table class="table ng-hide">
						<thead>
							<tr>
								<th>name </th>
								<th>Sign</th>
								<th>status</th>
								<th>action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="user in ctrl.users">
								<td>
								{{user.name}}</td>
								<td>
									{{user.day | date:'yyyy-MM-dd'}}
								</td>
								<td>{{user.sign}}</td>
								<td>
									<button class="btn btn-info" ng-if="user.sign == 'N'" ng-click="ctrl.sign(user)">sign</button>
									<button class="btn btn-info" ng-if="user.sign == 'Y'" ng-click="ctrl.unsign(user)">unsign</button>
									<button class="btn btn-primary" ng-click="ctrl.removeUser(user, $index)">
										Delete
									</button>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	<script src="../javascripts/angular.js"></script>
	<script src="../javascripts/jquery.min.js"></script>
	<script src="../javascripts/bootstrap.min.js"></script>

    <script src="../javascripts/logic/app.js"></script>
    <script src="../javascripts/logic/userService.js"></script>
    <script src="../javascripts/ui-bootstrap.js"></script>
    <script src="../javascripts/logic/directive/calendar.js"></script>
    <script src="../javascripts/less.min.js"></script>
	<script src="../javascripts/underscore.js"></script>
    <script src="../javascripts/moment.min.js"></script>
	 </body>
</html>