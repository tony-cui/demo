<!DOCTYPE html>
<html ng-app="app">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	    <meta charset="utf-8">
	    <title>Test</title>
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
	    <meta name="description" content="">

	    <link href="../stylesheets/bootstrap.min.css" rel="stylesheet" type="text/css">
	    <link rel="stylesheet" href="../stylesheets/dialogs.css">
	    <link rel="stylesheet" href="../stylesheets/calendar.css">
	    <link rel="stylesheet" href="../stylesheets/font-awesome.min.css">
	    <!-- <link href="//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"> -->
	</head>
	<body ng-controller="userController as ctrl">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-3">
					<calendar selected="day"></calendar>
				</div>
				<div class="col-md-6 well">
					<h4>过去两天未完成任务的工会成员</h4>
					<table class="table">
						<thead>
							<tr>
								<th>游戏名</th>
								<th>天数</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="item in ctrl.unSignUsers">
								<td>{{item._id}}</td>
								<td>{{item.count}}Day</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="row">
				<div class="col-md-9">
					<h3>工会玩家列表</h3>
					<button type="button" class="btn btn-primary" ng-click="ctrl.open()">
						添加工会成员
					</button>
					

					<!-- score part -->
					<table class="table">
						<thead>
							<tr>
								<th>游戏名</th>
								<th ng-repeat="day in ctrl.duration">{{day.format('MM-DD')}}</th>
								<th>累计未做天数</th>
								<th>当日完成情况</th>
								<th>操作</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="(name, scoreList) in ctrl.userListInPeriod">
								<td>{{name}}</td>
								<td ng-repeat="item in scoreList" ng-dblclick="ctrl.showEdit(item)" ng-class="ctrl.getCss(item)">
									<span ng-if="!item.edit">
										{{item.score}}
									</span>
									<input ng-if="item.edit" type="number" ng-model="item.score" ng-blur="ctrl.saveScore(item)" min="0" required>
								</td>
								<td>{{ctrl.unSignUsersTotal[name]}}</td>
								<td ng-class="ctrl.getCss(scoreList[scoreList.length-1])">{{scoreList[scoreList.length-1].sign}}</td>
								<td>
									<button class="btn btn-primary" ng-click="ctrl.removeUser(name, $index)">删除</button>
								</td>
							</tr>
						</tbody>
					</table>

					<!-- sign part -->
					<table class="table ng-hide">
						<thead>
							<tr>
								<th>name </th>
								<th>Sign</th>
								<th>status</th>
								<th>action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="user in ctrl.users">
								<td>
								{{user.name}}</td>
								<td>
									{{user.day | date:'yyyy-MM-dd'}}
								</td>
								<td>{{user.sign}}</td>
								<td>
									<button class="btn btn-info" ng-if="user.sign == 'N'" ng-click="ctrl.sign(user)">sign</button>
									<button class="btn btn-info" ng-if="user.sign == 'Y'" ng-click="ctrl.unsign(user)">unsign</button>
									<button class="btn btn-primary" ng-click="ctrl.removeUser(user, $index)">
										Delete
									</button>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	<script src="../javascripts/angular.js"></script>
	<script src="../javascripts/jquery.min.js"></script>
	<script src="../javascripts/bootstrap.min.js"></script>

    <script src="../javascripts/logic/app.js"></script>
    <script src="../javascripts/logic/userService.js"></script>
    <script src="../javascripts/logic/directive/calendar.js"></script>
    <script src="../javascripts/ui-bootstrap-tpls.min.js"></script>
    <script src="../javascripts/dialogs.min.js"></script>
    <script src="../javascripts/less.min.js"></script>
	<script src="../javascripts/underscore.js"></script>
    <script src="../javascripts/moment.min.js"></script>
   	<script src="../javascripts/angular-sanitize.min.js"></script>
   	<script src="../javascripts/angular-animate.min.js"></script>
	</body>
</html>